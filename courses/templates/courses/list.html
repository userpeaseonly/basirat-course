{% extends "base.html" %}
{% load i18n %}
{% block title %}{% trans "Courses" %}{% endblock %}
{% block content %}
<div class="container mx-auto px-4 py-8 max-w-7xl">
  <!-- Header -->
  <div class="mb-8">
    <h1 class="text-3xl font-bold text-gray-900 mb-2">{% trans "Courses" %}</h1>
    <p class="text-gray-600">{% trans "Explore available learning paths and start your journey" %}</p>
  </div>

  <!-- Search and Filter Bar -->
  <div class="bg-white rounded-lg shadow-md border border-gray-200 p-6 mb-8">
    <form method="get" class="flex flex-col md:flex-row gap-4">
      <!-- Search Input -->
      <div class="flex-1">
        <div class="relative">
          <input 
            type="text" 
            name="q" 
            value="{{ search_query }}" 
            placeholder="{% trans 'Search courses by name or description...' %}" 
            class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"
          >
          <svg class="absolute left-3 top-3.5 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
        </div>
      </div>

      <!-- Sort Dropdown -->
      <div class="md:w-64">
        <select 
          name="sort" 
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"
          onchange="this.form.submit()"
        >
          <option value="title" {% if sort_by == 'title' %}selected{% endif %}>{% trans "Sort: A-Z" %}</option>
          <option value="-title" {% if sort_by == '-title' %}selected{% endif %}>{% trans "Sort: Z-A" %}</option>
          <option value="lessons" {% if sort_by == 'lessons' %}selected{% endif %}>{% trans "Sort: Most Lessons" %}</option>
        </select>
      </div>

      <!-- Search Button -->
      <button type="submit" class="px-8 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-2">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
        {% trans "Search" %}
      </button>

      <!-- Clear Button -->
      {% if search_query %}
        <a href="{% url 'course_list' %}" class="px-6 py-3 bg-gray-200 text-gray-700 font-semibold rounded-lg hover:bg-gray-300 transition-colors flex items-center justify-center">
          {% trans "Clear" %}
        </a>
      {% endif %}
    </form>

    <!-- Results Count -->
    {% if search_query %}
      <div class="mt-4 pt-4 border-t border-gray-200">
        <p class="text-sm text-gray-600">
          {% blocktrans count counter=courses|length %}Found {{ counter }} course matching "{{ search_query }}"{% plural %}Found {{ counter }} courses matching "{{ search_query }}"{% endblocktrans %}
        </p>
      </div>
    {% endif %}
  </div>

  {% if courses %}
    <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
      {% for course in courses %}
        <article class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow">
          <!-- Course Header -->
          <div class="bg-gradient-to-r from-blue-500 to-blue-600 p-6 text-white">
            <h2 class="text-xl font-bold mb-2">{{ course.title }}</h2>
            <div class="flex items-center text-blue-100 text-sm">
              <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
              </svg>
              {% blocktrans count counter=course.lessons.count %}{{ counter }} lesson{% plural %}{{ counter }} lessons{% endblocktrans %}
            </div>
          </div>

          <!-- Course Body -->
          <div class="p-6">
            {% if course.description %}
              <p class="text-gray-600 mb-4 text-sm line-clamp-3">{{ course.description }}</p>
            {% else %}
              <p class="text-gray-400 italic mb-4 text-sm">{% trans "No description available" %}</p>
            {% endif %}

            <a href="{% url 'course_detail' course.slug %}" class="inline-flex items-center justify-center w-full px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors">
              {% trans "View Course" %}
              <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
              </svg>
            </a>
          </div>
        </article>
      {% endfor %}
    </div>
  {% else %}
    <!-- Empty State -->
    <div class="bg-white rounded-lg shadow-md p-12 text-center">
      <svg class="mx-auto h-24 w-24 text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
      </svg>
      <h3 class="text-xl font-semibold text-gray-900 mb-2">
        {% if search_query %}
          {% trans "No Courses Found" %}
        {% else %}
          {% trans "No Courses Available" %}
        {% endif %}
      </h3>
      <p class="text-gray-600 mb-4">
        {% if search_query %}
          {% trans "No courses match your search. Try different keywords or clear the search." %}
        {% else %}
          {% trans "Course catalog is empty at the moment. Please check back later." %}
        {% endif %}
      </p>
      {% if search_query %}
        <a href="{% url 'course_list' %}" class="inline-flex items-center px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors">
          {% trans "View All Courses" %}
        </a>
      {% endif %}
    </div>
  {% endif %}
</div>
{% endblock %}
